# 003. Hello World：第一个 Go 程序

本章通过一个最简单的 "Hello, World!" 程序，逐行拆解 Go 语言的基础结构，并介绍如何编译和运行代码。

---

## 1. 代码剖析

```go
package main

import "fmt"

func main() {
	fmt.Println("Hello, World!")
}
```

### 1.1 `package main` 是什么？

**包 (Package)** 是 Go 语言组织代码的基本单位。

* **`package` 关键字**：每个 `.go` 文件的**第一行**都必须声明它属于哪个包。
* **`main` 包的特殊性**：`main` 是一个特殊的包名，它告诉 Go 编译器："这不是一个库，而是一个**可执行程序**的入口。"
* **规则**：
  * 如果你写的是一个应用程序（要生成 `.exe` 或可执行文件），必须用 `package main`。
  * 如果你写的是一个供他人调用的库，则使用其他包名（如 `package utils`）。

### 1.2 `import "fmt"` 是什么？

**`fmt`** 是 Go 标准库中的一个包，名字来源于 "format"（格式化）。

* **作用**：提供格式化输入/输出的功能，类似于 C 语言的 `printf` 和 `scanf`。
* **`import` 关键字**：用于引入外部包。只有 `import` 之后，你才能使用该包提供的函数。
* **常用函数**：
  * `fmt.Println()`：打印内容并自动换行。
  * `fmt.Printf()`：格式化打印（支持占位符如 `%s`、`%d`）。
  * `fmt.Sprintf()`：格式化生成字符串（不直接打印）。

### 1.3 `func main()` 是什么？

**`main` 函数是 Go 可执行程序的入口点。**

* **`func` 关键字**：用于定义函数。
* **`main` 函数的特殊性**：
  1. 它是程序启动后**第一个被执行**的函数。
  2. 它**必须**位于 `package main` 中。
  3. 它**不接受任何参数**，也**不返回任何值**。
* **类比**：
  * Java 的 `public static void main(String[] args)`
  * C/C++ 的 `int main()`
  * Python 的 `if __name__ == "__main__":`

### 1.4 `fmt.Println("Hello, World!")` 做了什么？

```go
fmt.Println("Hello, World!")
```

* **`fmt`**：我们刚才导入的包。
* **`.Println`**：`fmt` 包导出的一个函数。
  * `Print`：打印。
  * `ln`：line，表示打印后自动换行。
* **`"Hello, World!"`**：一个**字符串字面量 (String Literal)**，用双引号包裹。
* **整体效果**：在控制台输出 `Hello, World!` 并换行。

---

## 2. 编译与运行

### 2.1 `go build` 做了什么？

`go build` 是 Go 的**编译命令**，它将你的源代码编译成**机器码**，生成一个独立的可执行文件。

```bash
# 在包含 main.go 的目录下执行
go build
```

**执行过程**：

1. **解析代码**：检查语法是否正确。
2. **解析依赖**：找到并编译所有 `import` 的包。
3. **编译**：将 Go 代码转换成目标平台的机器码。
4. **链接**：将你的代码与 Go 运行时 (Runtime) 打包在一起。
5. **输出**：生成可执行文件。

**生成的文件名**：

* 默认使用**当前目录名**或**模块名**。
* 可以用 `-o` 参数指定输出名称：`go build -o myapp.exe`

#### 不同操作系统的差异

| 操作系统 | 生成的文件       | 文件格式                             |
| -------- | ---------------- | ------------------------------------ |
| Windows  | `xxx.exe`      | PE (Portable Executable)             |
| macOS    | `xxx` (无后缀) | Mach-O                               |
| Linux    | `xxx` (无后缀) | ELF (Executable and Linkable Format) |

**Go 的特点：交叉编译**

Go 天生支持**交叉编译 (Cross-Compilation)**：你可以在 Windows 上编译出能在 Mac/Linux 上运行的程序，反之亦然。

```powershell
# 在 Windows 上为 Linux 编译
$env:GOOS="linux"; $env:GOARCH="amd64"; go build -o myapp_linux

# 在 Windows 上为 macOS 编译
$env:GOOS="darwin"; $env:GOARCH="amd64"; go build -o myapp_mac
```

**Go 编译的优势**：

* **单文件部署**：生成的可执行文件包含了所有依赖（包括 Go 运行时），不需要目标机器安装 Go 环境。
* **静态链接**：默认情况下，Go 使用静态链接，减少运行时依赖问题。
* **编译速度快**：Go 的编译器设计之初就追求极快的编译速度。

### 2.2 `go run` 做了什么？

`go run` 是一个**便捷命令**，它将编译和运行合二为一。

```bash
go run main.go
```

**执行过程**：

1. 在**临时目录**中编译你的代码。
2. 立即**运行**生成的可执行文件。
3. 运行结束后，**自动清理**临时文件。

**适用场景**：

* 快速测试代码逻辑。
* 学习阶段频繁修改代码。
* 不需要保留可执行文件时。

**与 `go build` 的区别**：

| 特性     | `go build`         | `go run`               |
| -------- | -------------------- | ------------------------ |
| 生成文件 | 生成持久的可执行文件 | 生成到临时目录，用完即删 |
| 执行方式 | 编译后需手动运行     | 编译并自动运行           |
| 适用场景 | 发布、部署、分发     | 开发、调试、学习         |

---

## 3. 运行可执行文件

### 3.1 为什么双击 `.exe` 会"闪退"？

你写的是一个**控制台应用程序**。当你双击运行时：

1. Windows 创建一个命令行窗口。
2. 程序打印 `Hello, World!`（这只需要几毫秒）。
3. 程序执行完毕，退出。
4. Windows 关闭命令行窗口。

**结果**：你看到窗口闪了一下就消失了。

### 3.2 正确的运行方式

在**已有的终端窗口**中运行可执行文件：

```powershell
# Windows PowerShell
.\main.exe

# 或者（如果文件名是 003-hello-world.exe）
.\003-hello-world.exe
```

### 3.3 `.\` 是什么意思？

`.\` 是**相对路径前缀**，表示"当前目录"。

| 符号               | 含义                 | 示例                                   |
| ------------------ | -------------------- | -------------------------------------- |
| `.\`             | 当前目录 (Windows)   | `.\main.exe` = 当前目录下的 main.exe |
| `./`             | 当前目录 (Mac/Linux) | `./main` = 当前目录下的 main         |
| `..\` 或 `../` | 上一级目录           | `..\other\file.exe`                  |

**为什么需要 `.\`？**

在 Windows PowerShell 和 Linux/macOS 的终端中，出于**安全考虑**，直接输入文件名默认**不会搜索当前目录**，只会搜索系统 PATH 环境变量中的目录。

* 如果你只输入 `main.exe`，系统会去 PATH 里找，找不到就报错。
* 加上 `.\` 明确告诉系统："就找当前目录下的这个文件！"

---

## 4. 本章小结

| 概念              | 说明                                     |
| ----------------- | ---------------------------------------- |
| `package main`  | 声明这是一个可执行程序的入口包           |
| `import "fmt"`  | 引入标准库的格式化 I/O 包                |
| `func main()`   | 程序入口点，第一个被执行的函数           |
| `fmt.Println()` | 打印内容并换行                           |
| `go build`      | 编译生成可执行文件，可交叉编译到其他平台 |
| `go run`        | 编译并立即运行，适合开发调试             |
| `.\` / `./`   | 当前目录前缀，用于明确执行本地文件       |

---

## 5. 动手练习

1. 修改 `main.go`，让它打印你的名字。
2. 尝试使用 `fmt.Printf("My name is %s\n", "YourName")` 进行格式化输出。
3. 在 PowerShell 中分别使用 `go build` 和 `go run` 运行程序，观察区别。
